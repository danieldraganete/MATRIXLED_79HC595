#include <Arduino.h>

 *** 74HC595 pin definitions ***
const int latchPin1 = 2;  // För kolumner
const int clockPin1 = 11;  
const int dataPin1 = 10;

const int latchPin2 = 3; // För rader
const int clockPin2 = 12; 
const int dataPin2 = 9;

// *** Scrollande meddelande ***
const char *msg = "WRITE HERE YOUR TEXT   !    !   !  ";
const int scrollSpeed = 35; 

// *** Font Definitions *** 
byte alphabets[][8] = {
  {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},  /*space*/
  {0x2a,0x1c,0x3e,0x1c,0x2a,0x00,0x00,0x00},  /***/
   {0x08,0x08,0x3e,0x08,0x08,0x00,0x00,0x00},  /*+*/
   {0x00,0x0d,0x0e,0x00,0x00,0x00,0x00,0x00},  /*,*/
   {0x08,0x08,0x08,0x08,0x08,0x00,0x00,0x00},  /*-*/
   {0x00,0x06,0x06,0x00,0x00,0x00,0x00,0x00},  /*.*/
   {0x03,0x04,0x08,0x10,0x60,0x00,0x00,0x00},  /*/*/
   {0x3e,0x45,0x49,0x51,0x3e,0x00,0x00,0x00},  /*0*/
   {0x00,0x21,0x7f,0x01,0x00,0x00,0x00,0x00},  /*1*/
   {0x31,0x43,0x45,0x49,0x31,0x00,0x00,0x00},  /*2*/
   {0x22,0x41,0x49,0x49,0x36,0x00,0x00,0x00},  /*3*/
   {0x08,0x18,0x28,0x7f,0x08,0x00,0x00,0x00},  /*4*/
   {0x72,0x51,0x51,0x51,0x4e,0x00,0x00,0x00},  /*5*/
   {0x3e,0x49,0x49,0x49,0x26,0x00,0x00,0x00},  /*6*/
   {0x60,0x40,0x47,0x48,0x70,0x00,0x00,0x00},  /*7*/
   {0x36,0x49,0x49,0x49,0x36,0x00,0x00,0x00},  /*8*/
   {0x32,0x49,0x49,0x49,0x3e,0x00,0x00,0x00},  /*9*/
   {0x00,0x63,0x63,0x00,0x00,0x00,0x00,0x00},  /*:*/
   {0x00,0x6d,0x6e,0x00,0x00,0x00,0x00,0x00},  /*;*/
   {0x08,0x14,0x22,0x00,0x00,0x00,0x00,0x00},  /*<*/
   {0x14,0x14,0x14,0x14,0x14,0x00,0x00,0x00},  /*=*/
   {0x00,0x22,0x14,0x08,0x00,0x00,0x00,0x00},  /*>*/
   {0x60,0x80,0x8d,0x90,0x60,0x00,0x00,0x00},  /*?*/
   {0x3e,0x41,0x5d,0x5d,0x38,0x00,0x00,0x00},  /*@*/
   {0x3f,0x48,0x48,0x48,0x3f,0x00,0x00,0x00},  /*A*/
   {0x7f,0x49,0x49,0x49,0x36,0x00,0x00,0x00},  /*B*/
   {0x3e,0x41,0x41,0x41,0x22,0x00,0x00,0x00},  /*C*/
   {0x7f,0x41,0x41,0x41,0x3e,0x00,0x00,0x00},  /*D*/   
   {0x7f,0x49,0x49,0x49,0x41,0x00,0x00,0x00},  /*E*/
   {0x7f,0x48,0x48,0x48,0x40,0x00,0x00,0x00},  /*F*/
   {0x3e,0x41,0x41,0x45,0x26,0x00,0x00,0x00},  /*G*/
   {0x7f,0x08,0x08,0x08,0x7f,0x00,0x00,0x00},  /*H*/  
   {0x41,0x41,0x7f,0x41,0x41,0x00,0x00,0x00},  /*I*/
   {0x46,0x41,0x41,0x41,0x7e,0x00,0x00,0x00},  /*J*/
   {0x7f,0x08,0x14,0x22,0x41,0x00,0x00,0x00},  /*K*/
   {0x7f,0x01,0x01,0x01,0x01,0x00,0x00,0x00},  /*L*/ 
   {0x7f,0x20,0x18,0x20,0x7f,0x00,0x00,0x00},  /*M*/
   {0x7f,0x10,0x08,0x04,0x7f,0x00,0x00,0x00},  /*N*/
   {0x3e,0x41,0x41,0x41,0x3e,0x00,0x00,0x00},  /*O*/
   {0x7f,0x48,0x48,0x48,0x30,0x00,0x00,0x00},  /*P*/
   {0x3e,0x41,0x45,0x43,0x3f,0x00,0x00,0x00},  /*Q*/
   {0x7f,0x48,0x4c,0x4a,0x31,0x00,0x00,0x00},  /*R*/
   {0x32,0x49,0x49,0x49,0x26,0x00,0x00,0x00},  /*S*/
   {0x60,0x40,0x7f,0x40,0x60,0x00,0x00,0x00},  /*T*/
   {0x7e,0x01,0x01,0x01,0x7e,0x00,0x00,0x00},  /*U*/
   {0x7c,0x02,0x01,0x02,0x7c,0x00,0x00,0x00},  /*V*/
   {0x7e,0x01,0x0e,0x01,0x7e,0x00,0x00,0x00},  /*W*/
   {0x63,0x14,0x08,0x14,0x63,0x00,0x00,0x00},  /*X*/
   {0x60,0x10,0x0f,0x10,0x60,0x00,0x00,0x00},  /*Y*/
   {0x43,0x45,0x49,0x51,0x61,0x00,0x00,0x00},  /*Z*/
   {0x7f,0x41,0x00,0x00,0x00,0x00,0x00,0x00},  /*[*/
   {0x3e,0x41,0x41,0x00,0x00,0x00,0x00,0x00},  /*<*/
   {0x41,0x7f,0x00,0x00,0x00,0x00,0x00,0x00},  /*]*/
   {0x08,0x10,0x20,0x10,0x08,0x00,0x00,0x00},  /*^*/
   {0x02,0x02,0x02,0x02,0x02,0x00,0x00,0x00},  /*_*/
   {0x00,0x00,0x70,0x78,0x08,0x00,0x00,0x00},  /*`*/
   {0x02,0x15,0x15,0x15,0x0f,0x00,0x00,0x00},  /*a*/
   {0x7f,0x09,0x11,0x11,0x0e,0x00,0x00,0x00},  /*b*/
   {0x0e,0x11,0x11,0x11,0x00,0x00,0x00,0x00},  /*c*/
   {0x0e,0x11,0x11,0x09,0x7e,0x00,0x00,0x00},  /*d*/
   {0x0e,0x15,0x15,0x15,0x0c,0x00,0x00,0x00},  /*e*/
   {0x08,0x3f,0x48,0x40,0x20,0x00,0x00,0x00},  /*f*/
   {0x18,0x25,0x25,0x25,0x1e,0x00,0x00,0x00},  /*g*/
   {0x7f,0x08,0x10,0x10,0x0f,0x00,0x00,0x00},  /*h*/
   {0x00,0x05,0x2f,0x01,0x00,0x00,0x00,0x00},  /*i*/
   {0x02,0x09,0x2f,0x08,0x00,0x00,0x00,0x00},  /*j*/
   {0x7f,0x04,0x0a,0x11,0x00,0x00,0x00,0x00},  /*k*/
   {0x00,0x41,0x7f,0x01,0x00,0x00,0x00,0x00},  /*l*/
   {0x1f,0x10,0x08,0x10,0x0f,0x00,0x00,0x00},  /*m*/
   {0x1f,0x10,0x10,0x10,0x0f,0x00,0x00,0x00},  /*n*/
   {0x0e,0x11,0x11,0x11,0x0e,0x00,0x00,0x00},  /*o*/
   {0x1f,0x14,0x14,0x14,0x08,0x00,0x00,0x00},  /*p*/
   {0x08,0x14,0x14,0x1f,0x01,0x00,0x00,0x00},  /*q*/
   {0x1f,0x08,0x10,0x10,0x08,0x00,0x00,0x00},  /*r*/
   {0x09,0x15,0x15,0x15,0x12,0x00,0x00,0x00},  /*s*/
   {0x08,0x3e,0x09,0x01,0x02,0x00,0x00,0x00},  /*t*/
   {0x1e,0x01,0x01,0x01,0x1f,0x00,0x00,0x00},  /*u*/
   {0x1c,0x02,0x01,0x02,0x1c,0x00,0x00,0x00},  /*v*/
   {0x1f,0x02,0x0c,0x02,0x1f,0x00,0x00,0x00},  /*w*/
   {0x11,0x0a,0x04,0x0a,0x11,0x00,0x00,0x00},  /*x*/
   {0x18,0x05,0x05,0x05,0x1e,0x00,0x00,0x00},  /*y*/
   {0x11,0x13,0x15,0x19,0x00,0x00,0x00,0x00},  /*z*/
   {0x08,0x36,0x41,0x41,0x00,0x00,0x00,0x00},  /*{*/
   {0x00,0x00,0x7f,0x00,0x00,0x00,0x00,0x00},  /*|*/
   {0x00,0x41,0x41,0x36,0x08,0x00,0x00,0x00},  /*}*/
   {0x08,0x10,0x08,0x04,0x08,0x00,0x00,0x00},  /*~*/
   {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00}
};

void setup() {
  // Set pin mode
  pinMode(latchPin1, OUTPUT);
  pinMode(clockPin1, OUTPUT);
  pinMode(dataPin1, OUTPUT);
  pinMode(latchPin2, OUTPUT);
  pinMode(clockPin2, OUTPUT);
  pinMode(dataPin2, OUTPUT);
}

void loop() {
  scrollMessage(msg);
}

void scrollMessage(const char *msg) {
  int msgLength = strlen(msg);
  
  for (int i = 0; i < msgLength + 1; i++) {
    for (int j = 0; j < 8; j++) {
      if (i + j < msgLength) {
        displayChar(msg[i + j], j);
      } else {
        displayChar(' ', j);
      }
    }
    delay(scrollSpeed);
  }
}

void displayChar(char c, int offset) {
  int charIndex = c - 32;
  
  digitalWrite(latchPin1, LOW);
  shiftOut(dataPin1, clockPin1, MSBFIRST, 1 << offset);
  digitalWrite(latchPin1, HIGH);

  for (int row = 0; row < 8; row++) {
    digitalWrite(latchPin2, LOW);
    shiftOut(dataPin2, clockPin2, MSBFIRST, alphabets[charIndex][row]);
    digitalWrite(latchPin2, HIGH);
    delayMicroseconds(100);
  }
}
